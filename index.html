<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>EXON Cinematic</title>
<style>
body {
  margin:0; padding:0; overflow:hidden;
  background:#000;
  font-family: "Courier New", monospace;
  color:#0f0;
}

/* Overlay */
#overlay {
  position:fixed; inset:0;
  background:#fff;
  display:flex; justify-content:center; align-items:center;
  cursor:pointer; z-index:9999;
  transition: background 0.8s ease;
}
#overlayText { font-size:1.2rem; color:#000; }

/* Lyrics */
#lyrics {
  position:absolute; top:50%; left:50%;
  transform:translate(-50%,-50%);
  font-size:2rem; white-space:pre-wrap;
  letter-spacing:2px; color:#0f0;
  text-shadow:0 0 2px #0f0,0 0 5px #0f0;
  z-index:1;
}

/* Cinéma bars */
#topBar, #bottomBar {
  position:fixed; left:0; right:0;
  height:20%; background:#000;
  z-index:2000;
  transition: all 1.5s ease-in-out;
}
#topBar { top:-20%; }
#bottomBar { bottom:-20%; }

/* Texte EXON */
#exon {
  position:fixed; top:50%; left:50%;
  transform:translate(-50%,-50%);
  font-size:5rem; font-weight:300; /* plus fin */
  color:#fff; letter-spacing:1rem;
  display:flex; gap:0.5rem;
  opacity:0; z-index:3000;
}
#exon span {
  display:inline-block;
  opacity:0;
  transform:scale(0.8);
}

/* Animations */
.fadeIn {
  animation: fadeIn 0.8s ease forwards;
}
.fadeOutLeft {
  animation: fadeOutLeft 1.5s ease forwards;
}
.fadeOutRight {
  animation: fadeOutRight 1.5s ease forwards;
}
.fadeOutSofterLeft {
  animation: fadeOutLeft 2.2s ease forwards;
}
.fadeOutSofterRight {
  animation: fadeOutRight 2.2s ease forwards;
}

@keyframes fadeIn {
  from { opacity:0; transform:scale(0.8); }
  to   { opacity:1; transform:scale(1); }
}
@keyframes fadeOutLeft {
  from { opacity:1; transform:translateX(0) scale(1); }
  to   { opacity:0; transform:translateX(-300px) scale(0.9); }
}
@keyframes fadeOutRight {
  from { opacity:1; transform:translateX(0) scale(1); }
  to   { opacity:0; transform:translateX(300px) scale(0.9); }
}
</style>
</head>
<body>

<div id="overlay">
  <div id="overlayText">Cliquez pour activer la musique</div>
</div>

<div id="lyrics"></div>
<div id="topBar"></div>
<div id="bottomBar"></div>
<div id="exon">
  <span id="E">E</span>
  <span id="X">X</span>
  <span id="O">O</span>
  <span id="N">N</span>
</div>

<audio id="song" preload="auto">
  <source src="musique.mp3" type="audio/mpeg">
</audio>

<script>
const overlay = document.getElementById('overlay');
const audio = document.getElementById('song');
const lyricsDiv = document.getElementById('lyrics');

const topBar = document.getElementById("topBar");
const bottomBar = document.getElementById("bottomBar");
const exon = document.getElementById("exon");
const E = document.getElementById("E");
const X = document.getElementById("X");
const O = document.getElementById("O");
const N = document.getElementById("N");

const text = "Are you trying to tell me you are not completely blown away by my magnificent entrance just now?".split(" ");

const musicStart = 75;   // 1:15
const lyricStart = 82.5; // 1:22.5
const lyricEnd   = 87;   // 1:27
const lyricDuration = lyricEnd - lyricStart;
const exonTime = 78;     // 1:18

let exonPlayed = false;

overlay.addEventListener('click', async () => {
  overlay.style.background = "#000";
  audio.currentTime = musicStart;
  await audio.play();
  setTimeout(()=> overlay.remove(), 800);

  audio.addEventListener("timeupdate", () => {
    const t = audio.currentTime;

    // Lyrics
    if (t >= lyricStart && t <= lyricEnd) {
      const elapsed = t - lyricStart;
      const wordIndex = Math.floor((elapsed / lyricDuration) * text.length);
      lyricsDiv.textContent = text.slice(0, wordIndex+1).join(" ");
    }

    // EXON animation
    if (t >= exonTime && !exonPlayed) {
      exonPlayed = true; // pour éviter de le relancer plusieurs fois
      exon.style.opacity = "1";

      // Barres ciné
      topBar.style.top = "0";
      bottomBar.style.bottom = "0";

      // Fade in des lettres
      [E,X,O,N].forEach((l,i)=> {
        setTimeout(()=> l.classList.add("fadeIn"), i*150);
      });

      // Puis fade out vers directions opposées
      setTimeout(()=>{
        E.classList.add("fadeOutLeft");
        N.classList.add("fadeOutRight");
        X.classList.add("fadeOutSofterLeft");
        O.classList.add("fadeOutSofterRight");
      }, 1200);
    }
  });
});
</script>

</body>
</html>
